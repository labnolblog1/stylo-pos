<!DOCTYPE html>
<html>
<head>
<title>Add Commission</title>
<meta charset="UTF-8">
<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    margin: 0;
}

.header {
    background: black;
    color: white;
    text-align: center;
    padding: 15px;
    font-size: 22px;
}

.top-bar {
    max-width: 900px;
    margin: 15px auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.container {
    max-width: 900px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 10px;
}

.sale {
    border-bottom: 1px dashed #ccc;
    padding: 12px 0;
}

.row {
    display: flex;
    justify-content: space-between;
    margin: 4px 0;
    font-size: 16px;
}

input[type="number"] {
    width: 120px;
    padding: 6px;
    font-size: 16px;
}

.save-btn {
    width: 100%;
    padding: 14px;
    font-size: 18px;
    background: black;
    color: white;
    border: none;
    cursor: pointer;
    margin-top: 20px;
}
</style>
</head>

<body>

<div class="header">Add Commission</div>

<div class="top-bar">
    <button onclick="window.location.href='index.html'">⬅ Home</button>
    <div>
        Select Date:
        <input type="date" id="datePicker">
    </div>
</div>

<div class="container" id="salesList"></div>

<button class="save-btn" onclick="saveCommissions()">Save Commission</button>

<script>
let allSales = JSON.parse(localStorage.getItem("sales")) || [];
let shownIndexes = [];

const dateInput = document.getElementById("datePicker");
dateInput.value = new Date().toISOString().slice(0,10);
dateInput.onchange = loadSales;

function loadSales() {
    const selectedDate = dateInput.value;
    const box = document.getElementById("salesList");
    box.innerHTML = "";
    shownIndexes = [];

    allSales.forEach((sale, index) => {
        if (sale.date === selectedDate) {
            shownIndexes.push(index);
            box.innerHTML += `
                <div class="sale">
                    <div class="row"><b>Salesman</b><span>${sale.salesman}</span></div>
                    <div class="row"><b>Amount</b><span>₹${sale.amount}</span></div>
                    <div class="row">
                        <b>Commission</b>
                        <input type="number"
                               value="${sale.commission || ''}"
                               onchange="updateCommission(${shownIndexes.length - 1}, this.value)">
                    </div>
                </div>
            `;
        }
    });

    if (shownIndexes.length === 0) {
        box.innerHTML = "<p>No bills for this date.</p>";
    }
}

function updateCommission(i, value) {
    allSales[shownIndexes[i]].commission = Number(value) || 0;
}

function saveCommissions() {
    localStorage.setItem("sales", JSON.stringify(allSales));
    alert("Commission saved");
}

loadSales();
</script>

</body>
</html>
