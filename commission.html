<!DOCTYPE html>
<html>
<head>
<title>Add Commission</title>
<meta charset="UTF-8">

<style>
body{
    margin:0;
    font-family:Arial;
    background:#f2f2f2;
}

.header{
    background:black;
    color:white;
    text-align:center;
    padding:15px;
    font-size:22px;
}

.nav{
    display:flex;
    justify-content:space-between;
    padding:10px;
}

.nav button{
    padding:8px 16px;
    font-size:14px;
    cursor:pointer;
}

.container{
    max-width:900px;
    margin:20px auto;
    background:white;
    padding:20px;
    border-radius:10px;
}

.sale{
    border-bottom:1px dashed #ccc;
    padding:10px 0;
}

.row{
    display:flex;
    justify-content:space-between;
    margin:6px 0;
    align-items:center;
}

input{
    width:80px;
    padding:4px;
}

.save-btn{
    background:green;
    color:white;
    border:none;
    padding:4px 8px;
    border-radius:6px;
    cursor:pointer;
}

.delete-btn{
    background:red;
    color:white;
    border:none;
    padding:4px 8px;
    border-radius:6px;
    cursor:pointer;
}
</style>
</head>

<body>

<div class="header">Add Commission (Today)</div>

<div class="nav">
    <button onclick="window.history.back()">‚¨Ö Back</button>
    <button onclick="window.location.href='index.html'">üè† Home</button>
</div>

<div class="container">
    <div id="commissionList"></div>
</div>

<script>

function loadCommissionPage(){

    const sales = JSON.parse(localStorage.getItem("sales")) || [];
    const today = new Date().toISOString().slice(0,10);
    const todaySales = sales.filter(s => s.date === today);

    const container = document.getElementById("commissionList");
    container.innerHTML = "";

    if(todaySales.length === 0){
        container.innerHTML = "<p>No sales today.</p>";
        return;
    }

    todaySales.forEach(sale => {

        container.innerHTML += `
            <div class="sale">
                <div class="row">
                    <b>${sale.salesman}</b>
                    <button class="delete-btn" onclick="deleteSale(${sale.id})">Delete</button>
                </div>

                <div class="row">
                    <span>Amount:</span>
                    <span>‚Çπ${sale.amount}</span>
                </div>

                <div class="row">
                    <span>Commission:</span>
                    <input type="number" id="comm_${sale.id}" value="${sale.commission}">
                    <button class="save-btn" onclick="saveCommission(${sale.id})">Save</button>
                </div>
            </div>
        `;
    });
}

function saveCommission(id){

    let sales = JSON.parse(localStorage.getItem("sales")) || [];

    sales = sales.map(s => {
        if(s.id === id){
            s.commission = Number(document.getElementById("comm_"+id).value);
        }
        return s;
    });

    localStorage.setItem("sales", JSON.stringify(sales));
    alert("Commission updated");
}

function deleteSale(id){

    if(!confirm("Delete this sale?")) return;

    let sales = JSON.parse(localStorage.getItem("sales")) || [];
    sales = sales.filter(s => s.id !== id);
    localStorage.setItem("sales", JSON.stringify(sales));

    alert("Sale deleted");
    loadCommissionPage();
}

loadCommissionPage();

</script>

</body>
</html>
